import{useRef as t,useState as e,useEffect as r}from"react";import{MutationTracker as i,getAttributeMutation as n,setAttributeMutated as u}from"mutation-tracker";import{isObject as o,some as a,forEach as l,map as d}from"lodash-es";function s(t,e,r,i){return new(r||(r=Promise))((function(n,u){function o(t){try{l(i.next(t))}catch(t){u(t)}}function a(t){try{l(i.throw(t))}catch(t){u(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}l((i=i.apply(t,e||[])).next())}))}function c(e,r){const n=t(i(e,{defaultValue:!1,initialMutation:{mutatedAttributes:null==r?void 0:r.initiallyTouched,mutatedValue:!0}})),u=t(i(e,{defaultValue:!1,initialMutation:{mutatedAttributes:null==r?void 0:r.initiallyDirty,mutatedValue:!0}}));return{errorStateTracker:t(i(e,{defaultValue:[]})).current,touchedStateTracker:n.current,dirtyStateTracker:u.current}}function f(t,e){return n(t,e)}function y(t,e,r){return u(t,e,r)}function F(t,e){return function t(e,r="",i="."){const n={};for(const u in e)if(e.hasOwnProperty(u)){const a=r?r+i+u:u;o(e[u])&&null!==e[u]?Object.assign(n,t(e[u],a,i)):n[a]=e[u]}return n}(t,"",e)}function m(t,e){const r=[];return function t(e,i="",n="."){for(const u in e)if(e.hasOwnProperty(u)){const a=i?`${i}.${u}`:u;o(e[u])&&null!==e[u]?t(e[u],a,n):r.push({key:a,value:e[u]})}}(t,"",e),r}function h(t,r){const[i,n]=e([]),{touchedStateTracker:u,dirtyStateTracker:o,errorStateTracker:s}=c(t,r),[,f]=e(0);function y(){f((t=>t+1))}return{errorFlatList:i,errors:s.state,touched:u.state,dirty:o.state,getFieldState:function(t,e,r){var i=s.getMutatedByAttributeName(t);return{name:t,currentValue:e,previousValue:r,touched:u.getMutatedByAttributeName(t),dirty:o.getMutatedByAttributeName(t),isValid:!!i.length,errors:i}},getFieldTouched:function(t){return u.getMutatedByAttributeName(t)},setFieldTouched:function(t,e){u.setMutatedByAttributeName(t,e),y()},setFieldsTouched:function(t,e){u.setMutatedByAttributeNames(t,e),y()},setTouchedAll:function(t){u.setAll(t),y()},getFieldDirty:function(t){return o.getMutatedByAttributeName(t)},setFieldDirty:function(t,e){o.setMutatedByAttributeName(t,e),y()},setFieldsDirty:function(t,e){o.setMutatedByAttributeNames(t,e),y()},setDirtyAll:function(t){o.setAll(t),y()},getFieldValid:function(t){var e;return(null!==(e=s.getMutatedByAttributeName(t).length)&&void 0!==e?e:0)<=0},getFieldErrors:function(t){var e=s.getMutatedByAttributeName(t);return d(e,(t=>t))},setErrorsAll:function(t){n(t),s.clear();var e=Object.groupBy(t,(({key:t})=>t));l(e,((t,e)=>{var r=(null==t?void 0:t.map((t=>t.message)))||[];s.setMutatedByAttributeName(r,e)}))},isFormDirty:function(){return a(m(o.state,"."),(t=>t.value))},isFormValid:function(){return!i.length}}}"function"==typeof SuppressedError&&SuppressedError;const g=function(t,i,n){const[u,o]=e(!1),{errorFlatList:a,errors:l,touched:d,dirty:c,getFieldTouched:f,setFieldTouched:y,setFieldsTouched:F,setTouchedAll:m,getFieldDirty:g,setFieldDirty:A,setFieldsDirty:v,setDirtyAll:T,getFieldValid:b,getFieldErrors:p,setErrorsAll:D,getFieldState:M,isFormDirty:V,isFormValid:B}=h(i,n);function S(){var t=!1;return(()=>{s(this,void 0,void 0,(function*(){return yield N().then((e=>t=e)).catch((()=>t=!1))}))})(),t}function N(){return t.validate(i).then((t=>(D(t),B())))}return r((()=>{S()}),[]),{errorFlatList:a,errors:l,touched:d,dirty:c,isSubmitting:u,isFormDirty:V,isFormValid:B,validateAsync:N,validate:S,setIsSubmitting:function(t){o(t)},getFieldState:M,getFieldTouched:f,setFieldTouched:y,setFieldsTouched:F,setTouchedAll:m,getFieldDirty:g,setFieldDirty:A,setFieldsDirty:v,setDirtyAll:T,getFieldValid:b,getFieldErrors:p}};export{F as flattenObject,m as flattenObjectToArray,f as getDeep,y as setDeep,h as useFormFieldState,g as useMabel,c as useStateTrackers};
//# sourceMappingURL=index.mjs.map
