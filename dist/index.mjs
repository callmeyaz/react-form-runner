import{useRef as t,useState as e,useEffect as r}from"react";import{MutationTracker as i,getAttributeMutation as u,setAttributeMutated as n}from"mutation-tracker";import{isObject as o,some as a,forEach as l,map as d}from"lodash-es";function s(t,e,r,i){return new(r||(r=Promise))((function(u,n){function o(t){try{l(i.next(t))}catch(t){n(t)}}function a(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?u(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}l((i=i.apply(t,e||[])).next())}))}function c(e,r){const u=t(i(e,{defaultValue:!1,initialMutation:{mutatedAttributes:null==r?void 0:r.initiallyTouched,mutatedValue:!0}})),n=t(i(e,{defaultValue:!1,initialMutation:{mutatedAttributes:null==r?void 0:r.initiallyDirty,mutatedValue:!0}}));return{errorStateTracker:t(i(e,{defaultValue:[]})).current,touchedStateTracker:u.current,dirtyStateTracker:n.current}}function f(t,e){return u(t,e)}function y(t,e,r){return n(t,e,r)}function F(t,e){return function t(e,r="",i="."){const u={};for(const n in e)if(e.hasOwnProperty(n)){const a=r?r+i+n:n;o(e[n])&&null!==e[n]?Object.assign(u,t(e[n],a,i)):u[a]=e[n]}return u}(t,"",e)}function m(t,e){const r=[];return function t(e,i="",u="."){for(const n in e)if(e.hasOwnProperty(n)){const a=i?`${i}.${n}`:n;o(e[n])&&null!==e[n]?t(e[n],a,u):r.push({key:a,value:e[n]})}}(t,"",e),r}function h(t,r){const[i,u]=e([]),{touchedStateTracker:n,dirtyStateTracker:o,errorStateTracker:s}=c(t,r),[,f]=e(0);function y(){f((t=>t+1))}return{errorFlatList:i,errors:s.state,touched:n.state,dirty:o.state,getFieldState:function(t,e,r){var i=s.getMutatedByAttributeName(t);return{name:t,currentValue:e,previousValue:r,touched:n.getMutatedByAttributeName(t),dirty:o.getMutatedByAttributeName(t),isValid:!!i.length,errors:i}},getFieldTouched:function(t){return n.getMutatedByAttributeName(t)},setFieldTouched:function(t,e){n.setMutatedByAttributeName(t,e),y()},setFieldsTouched:function(t,e){n.setMutatedByAttributeNames(t,e),y()},setTouchedAll:function(t){n.setAll(t),y()},getFieldDirty:function(t){return o.getMutatedByAttributeName(t)},setFieldDirty:function(t,e){o.setMutatedByAttributeName(t,e),y()},setFieldsDirty:function(t,e){o.setMutatedByAttributeNames(t,e),y()},setDirtyAll:function(t){o.setAll(t),y()},getFieldValid:function(t){var e;return(null!==(e=s.getMutatedByAttributeName(t).length)&&void 0!==e?e:0)<=0},getFieldErrors:function(t){var e=s.getMutatedByAttributeName(t);return d(e,(t=>t))},setErrorsAll:function(t){u(t),s.clear();var e=Object.groupBy(t,(({key:t})=>t));l(e,((t,e)=>{var r=(null==t?void 0:t.map((t=>t.message)))||[];s.setMutatedByAttributeName(r,e)}))},isFormDirty:function(){return a(m(o.state,"."),(t=>t.value))},isFormValid:function(){return!i.length}}}"function"==typeof SuppressedError&&SuppressedError;var g=Object.freeze({__proto__:null,useFormValidation:function(t,i,u){const[n,o]=e(!1),{errorFlatList:a,errors:l,touched:d,dirty:c,getFieldTouched:f,setFieldTouched:y,setFieldsTouched:F,setTouchedAll:m,getFieldDirty:g,setFieldDirty:A,setFieldsDirty:v,setDirtyAll:b,getFieldValid:T,getFieldErrors:p,setErrorsAll:D,getFieldState:M,isFormDirty:V,isFormValid:B}=h(i,u);function S(){var t=!1;return(()=>{s(this,void 0,void 0,(function*(){return yield N().then((e=>t=e)).catch((()=>t=!1))}))})(),t}function N(){return t.validate(i).then((t=>(D(t),B())))}return r((()=>{S()}),[]),{errorFlatList:a,errors:l,touched:d,dirty:c,isSubmitting:n,isFormDirty:V,isFormValid:B,validateAsync:N,validate:S,setIsSubmitting:function(t){o(t)},getFieldState:M,getFieldTouched:f,setFieldTouched:y,setFieldsTouched:F,setTouchedAll:m,getFieldDirty:g,setFieldDirty:A,setFieldsDirty:v,setDirtyAll:b,getFieldValid:T,getFieldErrors:p}}});export{F as flattenObject,m as flattenObjectToArray,f as getDeep,y as setDeep,h as useFormFieldState,g as useMabel,c as useStateTrackers};
//# sourceMappingURL=index.mjs.map
